---
title: "Лабораторная работа 3"
author: "Габдулханов Марсель РИ-440004"
output: html_document
---

### Задание 1
1. Используйте команду ``readLines`` для загрузки файла в текстовый вектор _html_.
    1) Сколько строк в файле?
    2) Сколько символов в файле?
```{r}
html = readLines("forbes.htm")
```
Количество строк
```{r}
length(html)
```
Количество символов
```{r}
sum(nchar(html))
```
2. Откройте файл в текстовом редакторе. Найдите строки, содержащие данные о Билле Гейтсе и Ларри Эллисоне и запомните размер их дохода.
Билл Гейтс: $72 B
Ларри Эллисон: $41 B
3. Напишите шаблон регулярного выражения и используйте функцию ``grep``, чтобы извлечь размер дохода из данных в векторе _html_.
Удостоверьтесь, что полученный вектор номеров строк содержит содержит ровно 100 записей и ссылается на номера строк в котрых действительно есть
информация о доходе, а не просто первый попавшийся текст.
```{r}
income<-grep("\\$[0-9,]+ B",html)

length(income)

income
```
4. Напишите код, использовав регулярное выражение из п. 3, и функции ``regexp`` и ``regmatches``, чтобы извлечь все данные о доходе.
```{r}
incomep<-regexpr("\\$[0-9,]+ B",html)
incomeAll<-regmatches(html,incomep)

incomep<-regexpr("[0-9,]+",incomeAll);
worths<-regmatches(incomeAll,incomep);
worths<-as.double(gsub(",",".",worths))*10^9;
worths
df<-data.frame(incomeAll, worths)
names(df)<-c("Name", "Worth")

df
```
Проверьте следующее:

1 Должно быть ровно сто значений.
```{r}
length(incomeAll)
```
2 Самый большой доход должен быть доход Билла Гейтса
```{r}
incomeAll[1]
```
3 Такой доход должен быть в списке один раз.
```{r}
length(incomeAll[incomeAll=="$72 B"])
```
4 В всписке должна быть цифра, которую мы запомнили для Ларри Эллисона.
```{r}
incomeAll[incomeAll=="$41 B"] 
```
5 Должно быть как минимум два значения, встречающихся несколько раз.
```{r}
length(incomeAll)-length(unique(incomeAll))
```

```{r}
nrow(df)
richest<-df[df$Worth == max(df$Worth),]
richest

df[df$Name == "Larry Ellison",]
df[duplicated(df$Worth),][1:10,]
```

### Задание 2
1. В данных доход представлен в формате **"$42 B"**, что означает **42 × 10^9**.
```{r}
worths
```
Преобразуйте этот формат в числовой и сохраните в вектор _worths_. Удостоверьтесь в следующем:

1 worths является вектором и в нём сто занчений типа double.
```{r}
nrow(richest)
```
2 Все элементы вектора worths больше 1 миллиарда.
```{r}
worths<-worths * 10 ** 9
```
3 Самое большое число это доход Билла Гейтса.
```{r}
max(worths)
```
 
2. Используйте вектор _worths_ , чтобы выяснить следующее:

1 Какова медиана ста этих записей?
```{r}
median(worths)
```
2 Средний доход?
```{r}
mean(worths)
```
3 Как много людей из этого списка имеют доход больше 5млрд., 10, 25? 
```{r}
sum(worths > 5 * 10 ** 9)
sum(worths > 10 * 10 ** 9)
sum(worths > 25 * 10 ** 9)
```
4 Какой их общий доход?
```{r}
sum(worths)
```
5 Какую долю от общего дохода, составляет пятёрка самых богатых.
```{r}
sum(worths[1:5]) / sum(worths)
```
6 Какую долю от общего дохода, составляют 20 самых богатых.
```{r}
sum(worths[1:20]) / sum(worths)
```
7 В данных [федерального резерва США](https://www.federalreserve.gov/releases/z1/current/z1.pdf) найдите показатель дохода всех домохозяйств (Household net worth) в соответвующем году, какую долю общего дохода составляют 100 богатейших людей.
```{r}
sum(worths) / ( 86287.3 * 10 ** 9)
```
